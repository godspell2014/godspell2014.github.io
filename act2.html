<html>
<head>
<style>
h1 {color:#00ff00;}
</style>
</head>
<script>

var total_seconds = 0;
var start_seconds = 0;
var show_clock = {hours: 0, seconds: 0, minutes: 0};
var next_clock = {hours: 0, seconds: 0, minutes: 0};
var next_song;
var song_idx=0;
var seconds_till_next =0;
var songs=new Array();
songs[0]= {name: "Turn Back O Man", start: (2*60 + 47)}
songs[1]= {name: "Alas for You", start: (11*60 + 2)}
songs[2] = {name: "By My Side", start: (19*60 + 44)}
songs[3] = {name: "We Beseech Thee", start: (28*60 + 22)}
songs[4] = {name: "Beautiful City", start: (31*60 + 40)}
songs[5] = {name: "On the Willows", start: (37*60 + 20)}
songs[6] = {name: "Finale", start: (43*60 + 55)}

function starttimer() {
	
	start_seconds = Math.floor(new Date() / 1000);
	timercount();	
}

function timercount(){
  
	//set frequency of timer increment
	setTimeout("timercount()",1000);

	//look for song changes
	updateSongName();

	//update total show time
	document.getElementById("showclock").innerHTML=
		converttoclock(total_seconds, show_clock);
	
	//update next song countdown
	seconds_till_next = songs[song_idx].start - total_seconds;
	document.getElementById("nextclock").innerHTML=
		converttoclock(seconds_till_next, next_clock);

	if(seconds_till_next < 30)
		flash();

	total_seconds = Math.floor(new Date() / 1000) - start_seconds;
}

function converttoclock(seconds, clock){

	var minstr;
	var secstr;
	var hrstr;
		
	clock.hours = Math.floor(seconds/3600);
	if(clock.hours < 10) hrstr = "0" + clock.hours;
	else hrstr = clock.hours;
	
	clock.minutes = Math.floor((seconds - clock.hours*3600)/60);
	if(clock.minutes < 10) minstr = "0" + clock.minutes;
	else minstr = clock.minutes;
	
	clock.seconds = seconds%60;
	if(clock.seconds < 10) secstr = "0" + clock.seconds;
	else secstr = clock.seconds;

	return (hrstr + ":" + minstr + ":" + secstr);
}

function updateSongName(){

	var found = 0;
	var i=0;
	for(i;i<songs.length;i++){
		if(total_seconds == songs[i].start){
			song_idx++;
			break;
		}
	}
	
	if(song_idx == songs.length){
	document.getElementById("nextsong").innerHTML="Intermission";
	document.getElementById("nextclock").innerHTML="Intermission";
	}
	else{
	document.getElementById("nextsong").innerHTML="Next: " + songs[song_idx].name;
	}
}

var flash_count = 0;
var NUM_FLASHES = 1;
function flash(){
	
	if(flash_count == 2*NUM_FLASHES){
		flash_count = 0;
		return;
	}

	//document.getElementById("menu").style.background = 'black';
	if(flash_count % 2 == 0){
		document.body.style.background = 'white';
		flash_count++;
	}
	else if(flash_count % 2 == 1){
		document.body.style.background = 'black';
		flash_count++;
	}
	
	setTimeout(flash, 500);
}



</script>
<body onload="starttimer()" bgcolor = 'black' align='center'>

	<div>
	<h1 id="showclock"></h1>
	</div>
	<div>
	<h1 id="nextsong"></h1>
	</div>
	<div>
	<h1 id="nextclock"></h1>
	</div>

</body></html>