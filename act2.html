<html>
<head>
<style>
h1 {color:#00ff00;}
</style>
</head>

<script src="act2_songs.js"></script>
<script>

var total_seconds = 0;
var start_seconds = 0;
var show_clock = {hours: 0, seconds: 0, minutes: 0};
var next_clock = {hours: 0, seconds: 0, minutes: 0};
var next_song;
var song_idx=0;
var seconds_till_next =0;

function starttimer() {
	
	start_seconds = Math.floor(new Date() / 1000);
	timercount();	
}

function timercount(){
  
	//set frequency of timer increment
	setTimeout("timercount()",1);

	//look for song changes
	updateSongName();

	//update total show time
	document.getElementById("showclock").innerHTML=
		converttoclock(total_seconds, show_clock);
	
	//update next song countdown
	seconds_till_next = songs[song_idx].start - total_seconds;
	document.getElementById("nextclock").innerHTML=
		converttoclock(seconds_till_next, next_clock);

	if(seconds_till_next < 30)
		flash();

	//total_seconds = Math.floor(new Date() / 1000) - start_seconds;
	total_seconds++;
}

function converttoclock(seconds, clock){

	var minstr;
	var secstr;
	var hrstr;
		
	clock.hours = Math.floor(seconds/3600);
	if(clock.hours < 10) hrstr = "0" + clock.hours;
	else hrstr = clock.hours;
	
	clock.minutes = Math.floor((seconds - clock.hours*3600)/60);
	if(clock.minutes < 10) minstr = "0" + clock.minutes;
	else minstr = clock.minutes;
	
	clock.seconds = seconds%60;
	if(clock.seconds < 10) secstr = "0" + clock.seconds;
	else secstr = clock.seconds;

	return (hrstr + ":" + minstr + ":" + secstr);
}

function updateSongName(){

	var i=0;
	for(i;i<songs.length;i++){
		if(total_seconds == songs[i].start){
			song_idx++;
			break;
		}
	}
	
	if(song_idx == songs.length){
	window.location.href = "act2_ready.html";
	}
	else{
	document.getElementById("nextsong").innerHTML=songs[song_idx].name;
	}
}

var flash_count = 0;
var NUM_FLASHES = 1;
function flash(){
	
	if(flash_count == 2*NUM_FLASHES){
		flash_count = 0;
		return;
	}

	//document.getElementById("menu").style.background = 'black';
	if(flash_count % 2 == 0){
		document.body.style.background = 'grey';
		flash_count++;
	}
	else if(flash_count % 2 == 1){
		document.body.style.background = 'black';
		flash_count++;
	}
	
	setTimeout(flash, 500);
}

</script>
<body onload="starttimer()" bgcolor = 'black' align='center'>

	<div id="topspacer" 
		style="height:200px;width:400px">
	</div>
	<div>
		<p style="font-family:arial;color:white;font-size:20px;">Elapsed Time</p>
	</div>
	<div>
	<h1 id="showclock"></h1>
	</div>
	
	<div>
		<p style="font-family:arial;color:white;font-size:20px;">Next Song</p>
	</div>
	<div>
	<h1 id="nextsong"></h1>
	</div>
	
	<div>
		<p style="font-family:arial;color:white;font-size:20px;">Time Until Next</p>
	</div>
	<div>
	<h1 id="nextclock"></h1>
	</div>

</body>
</html>